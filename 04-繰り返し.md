
#コンピュータの得意な仕事(繰り返し)

##学習目標
- 繰り返しのあるプログラムの実行順序を理解し，応用してプログラムが書けるようになる

## 繰り返し
今回のテーマは同じ命令を何度も書かずに，コンピュータに繰り返しさせることです．

繰り返しプログラムを見ていく前に，何を繰り返すか考えていきましょう．

### 何を繰り返すのか
何回も出てきた，家のプログラムを見てみましょう．

```{#lst:4-1 .javascript .numberLines caption="House"}
var t = createTurtle();
{// 屋根を書く
	t.rt(30);
	t.fd(50);
	t.rt(120);
	t.fd(50);
	t.rt(120);
	t.fd(50);
	t.rt(120);
	t.lt(30);
}

{// 本体を書く
	t.rt(90);
	t.fd(50);
	t.rt(90);
	t.fd(50);
	t.rt(90);
	t.fd(50);
	t.rt(90);
	t.fd(50);
}
```

このプログラム，何度も同じことを書いている個所が2箇所ありますね．どこが同じか考えてみましょう．

### 繰り返しを使ったプログラム
繰り返しを使って，すっきりとしたプログラムにしてみましょう．

<!-- リスト 5.2.2.1 WhileHouse.java -->
```{#lst:4-1 .javascript .numberLines caption="House"}
var t = createTurtle();

{// 屋根を書く
  t.rt(30);
  var i = 1;
  while (i <= 3) {
    t.fd(50);
    t.rt(120);
    i = i + 1;
  }
  t.lt(30);// 上向きに戻す
}

{// 本体を書く
  var i = 1;
  while (i <= 4) {
    t.rt(90);
    t.fd(50);
    i = i + 1;
  }
}
```

今回登場した"繰り返し"を使うと，プログラムを繰り返すことができます．

繰り返しの一般的な形は次のとおりです．

```
while( [条件式] ) {
	処理
}
```
				
条件式が成立(true)のした場合には，処理が実行されます．不成立(false)の場合は処理を飛ばします．

処理が実行し終わると，もう一度条件式を評価します．

これを，条件式が不成立(false)になるまで繰り返します．

これをフローチャートと呼ばれる図を用いて書くと，次のようになります．

#### プログラムのフローチャート
![](img/chapter04/while_flow_chart_concrete.gif)

#### 繰り返しのフローチャート
![](img/chapter04/while_flow_chart.gif)

条件式は前回の条件分岐によるプログラムで学習した書式と同じ書式が使えます． 繰り返しを止めるために，変数を使います．この変数には，「今何回繰り返したか」といった情報を格納しておきます．

### 繰り返しを使ったプログラムの実行過程
プログラムの実行過程と変数の値の変化を見ていきましょう．

1. 変数の宣言
![](img/chapter04/table_model_i_01.gif)

2. 変数を初期化する(1を代入)
![](img/chapter04/table_model_i_02.gif)

3. 変数を評価して条件を判定する
![](img/chapter04/table_model_i_03.gif)

4. 変数に1を加える
![](img/chapter04/table_model_i_04.gif)

変数が，5になったときに条件式が不成立(false)になるので，繰り返しが終ります． これで4回繰り返されるのが分かるでしょうか？

## 応用：円を書くプログラム
繰り返しを使うと，円を簡単に書くことができます．次のプログラムを実行してみましょう．

### 円を書きつづけるプログラム
<!-- リスト 5.3.1.1 Circle.java -->
```{#lst:4-1 .javascript .numberLines caption="Circle"}
var t = createTurtle();

{// 円を書く
	while (true) {
		t.fd(1);
		t.rt(1);
	}
}
```

## for文
（書き加える）
このプログラムでは，繰り返しをfor文を使って書いています．for文を使うと，while文よりも短く書くことができます．

for文の()の中の命令は，それぞれwhile文と以下のように対応しています．

!!!Javascriptバージョンにすること
![while文とfor文](img/chapter04/while_and_for.png)

i = i + 1 と i++ は，いずれも i に 1 を足す，という意味です．while文で i++ と書くことも，for文で i = i + 1 と書くこともできます．

## 練習問題
### 円を描くプログラムを改良しよう
最後に出てきた円を描くプログラムは，条件が無い(常に成立(true))ので止まりません． 変数をつけ，適切な条件式を考えて，一周したらプログラムを止めるように改良して下さい．

ファイル名は「Circle.java」とすること．

### 円の描かれ方について考察しよう
一回の繰り返しで動く大きさ(fd(1))と，角度(rt(1))の数字を変更すと，円の大きさを変えることができます． いろいろ数字を変えて，どのようにすると自分の思った円がかけるか，考察してください．

ヒント: 大きさと角度を入力できるようにすると，数字を変えるたびにコンパイルする必要がないので，いろいろ実験できますよ． そのようなプログラムにしてから，実験することをお奨めします．

### 四角形を繰り返しを使って描こう
四角形を描くプログラムを繰り返しを使って書いてみましょう．

ファイル名は「Box.java」とすること．

### 五角形を繰り返しを使って描こう
五角形を描くプログラムを繰り返しを使って書き直してみましょう．

ファイル名は「Pentagon3.java」とすること．

### 星を繰り返しを使って描こう
星を描くプログラムを繰り返しを使って書き直してみましょう．

ファイル名は「Star3.java」とすること．

### アスタリスクを繰り返しを使って描こう
アスタリスクを描くプログラムを繰り返しを使って書いてみましょう．

![アスタリスク](img/chapter04/q_asterisk.jpg)

ファイル名は「Asterisk.java」とすること．
